<section>
    <div>
        <mat-horizontal-stepper #stepper>
            <mat-step [stepControl]="firstFormGroup" errorMessage="Something wrong.">
              <form [formGroup]="firstFormGroup">
                <ng-template matStepLabel>Student details</ng-template>
               <div class="form__fields">
                <div>
                    <mat-form-field>
                        <mat-label>First Name</mat-label>
                        <input matInput placeholder="First name" formControlName="firstName" required>
                      </mat-form-field>
                    <mat-form-field>
                        <mat-label>Last Name</mat-label>
                        <input matInput placeholder="Last name" formControlName="lastName" required>
                      </mat-form-field>
                </div>
                <div>
                    <mat-form-field>
                        <mat-label>Login</mat-label>
                        <input matInput placeholder="Login" formControlName="login" required>
                      </mat-form-field>
                    <mat-form-field>
                        <mat-label>Private Email</mat-label>
                        <input matInput placeholder="Private Email" formControlName="privateEmail" required>
                      </mat-form-field>
                </div>
                <div>
                    <mat-form-field>
                        <mat-label>University Email</mat-label>
                        <input matInput placeholder="University Email" formControlName="universityEmail" required>
                      </mat-form-field>
                      <mat-form-field appearance="fill">
                        <mat-label>Gender</mat-label>
                        <mat-select formControlName="gender">
                          <mat-option value="FEMALE">Female</mat-option>
                          <mat-option value="MALE">Male</mat-option>
                        </mat-select>
                      </mat-form-field>
                </div>
                
               </div>
                
                <div>
                  <button mat-button matStepperNext>Next</button>
                </div>
              </form>
            </mat-step>
            <mat-step [stepControl]="secondFormGroup" errorMessage="Address is required.">
              <form [formGroup]="secondFormGroup">
                <ng-template matStepLabel>Student address</ng-template>
                  <div>
                    <mat-form-field>
                        <mat-label>Passport</mat-label>
                        <input matInput placeholder="passport" formControlName="passport" required>
                      </mat-form-field>
                    <mat-form-field>
                        <mat-label>Citizen</mat-label>
                        <input matInput placeholder="citizen" formControlName="citizen" required>
                      </mat-form-field>
                </div>
                <div>
                    <mat-form-field appearance="fill">
                        <mat-label>Choose a date</mat-label>
                        <input formControlName="birthDay" matInput [matDatepicker]="picker">
                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-datepicker #picker></mat-datepicker>
                      </mat-form-field>
                </div>    
                <div>
                    <mat-radio-group formControlName="studentStatus">
                        <mat-radio-button class="example-margin" value="STUDYING">
                          Studying
                        </mat-radio-button>
                        <mat-radio-button class="example-margin" value="NOT_STUDYING">
                          Not studying
                        </mat-radio-button>
                      </mat-radio-group>
                </div>
                <div>
                    <mat-form-field>
                        <mat-label>Street</mat-label>
                        <input matInput placeholder="street" formControlName="street" required>
                      </mat-form-field>
                      <mat-form-field>
                        <mat-label>Postal Code</mat-label>
                        <input matInput placeholder="postalCode" formControlName="postalCode" required>
                      </mat-form-field>
                      <mat-form-field>
                        <mat-label>City</mat-label>
                        <input matInput placeholder="city" formControlName="city" required>
                      </mat-form-field>
                </div>
                <div>
                  <button mat-button matStepperPrevious>Back</button>
                  <button mat-button matStepperNext>Next</button>
                </div>
              </form>
            </mat-step>
            <mat-step [stepControl]="thridFormGroup" errorMessage="Student specialization is required.">
              <form [formGroup]="thridFormGroup">
                <ng-template matStepLabel>Student course</ng-template>
                <mat-form-field appearance="fill">
                  <mat-label>Course</mat-label>
                  <mat-select formControlName="course" (selectionChange)="getCourseSpecializations($event.value)">
                    <mat-option *ngFor="let course of courses" [value]="course.id">{{course.name}}</mat-option>
                  </mat-select>
                </mat-form-field>
                <ng-container *ngIf="specializations != null">
                  <mat-form-field appearance="fill">
                    <mat-label>Specializations</mat-label>
                    <mat-select formControlName="specialization">
                      <mat-option *ngFor="let specialization of specializations" [value]="specialization">{{specialization.name}}</mat-option>
                    </mat-select>
                  </mat-form-field>
                </ng-container>

               <div>
                <mat-form-field appearance="fill">
                  <mat-label>Roles</mat-label>
                  <mat-select [formControl]="rolesFormControl" multiple>
                    <mat-select-trigger>
                      {{rolesFormControl.value ? rolesFormControl.value[0].name : ''}}
                      <span *ngIf="rolesFormControl.value?.length > 1" class="example-additional-selection">
                        (+{{rolesFormControl.value.length - 1}} {{rolesFormControl.value?.length === 2 ? 'other' : 'others'}})
                      </span>
                    </mat-select-trigger>
                    <mat-option *ngFor="let role of roles" [value]="role">{{role.name}}</mat-option>
                  </mat-select>
                </mat-form-field>
               </div>
               <button mat-button (click)="createUser(stepper)">Create student</button>
              </form>
            </mat-step>


            <mat-step *ngIf="semester != null" errorMessage="Address is required.">
              <form>
                <ng-template matStepLabel>Student subjects</ng-template>
                
                <div>
                  <h3>Semester name: {{semester?.name}}</h3>
                  <h3>Semester number: {{semester?.semesterNumber}}</h3>
                </div>
                
                <div *ngFor="let subject of semester.subjects">
                    <h3>{{subject.name}}</h3>
                    <em>{{subject.type}}</em>
                    <mat-form-field appearance="fill">
                      <mat-label>Teacher</mat-label>
                      <mat-select [disabled]="isChecked && currentSubjectId == subject.id" (selectionChange)="addStudentGradeToArray(semester, subject, $event.value)">
                        <mat-option *ngFor="let teacher of subject.teachers" [value]="teacher">{{teacher.firstName}} {{teacher.lastName}}</mat-option>
                      </mat-select>
                    </mat-form-field>
                    <button mat-button (click)="edit(subject)">Edit</button>
                </div>
                <button mat-button (click)="createStudentGrades()">Done</button>
              </form>
            </mat-step>
          </mat-horizontal-stepper>
    </div>
</section>